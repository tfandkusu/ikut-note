# iKut Note

# iKut 3 の課題

2023年04月18日に「iKut 3」を公開した。

- [スプラトゥーン3で、やられたシーンをOBSのリプレイバッファで自動保存する](https://qiita.com/tfandkusu/items/1131a9a549249b5d8cfe)
- [ソースコード](https://github.com/tfandkusu/ikut3)
- [デプロイ先](https://s3.ikut.app/)

大手ニュースサイトでも紹介された。

[「スプラトゥーン3」で敵に倒されたシーンだけを自動録画できるウェブアプリ「iKut 3」でグングン上達できる環境を作ってみたよレビュー](https://gigazine.net/news/20230503-ikut3-splatoon-3-replay/)

2023年07月から「スプラトゥーン3」のプレイ時間を増やしてアプリを使っているが、以下の2つの課題に気がついた。

- 1ディレクトリに大量のリプレイバッファが保存され、どのファイルが前の試合のリプレイバッファか分からない
- リプレイバッファを見るために適切な動画プレイヤーアプリが無い
- リプレイバッファを見て気がついたことがあっても、書き留める場所が無い

この2つの課題を解決するために、新たなアプリ「iKut Note」を作成する。

# 開発および実行環境

Go 言語によるローカル PC で動く Web サーバとして開発する。UI は Google Chrome が提供する。

ユーザーから見た分かりやすさを優先するならば「iKut 3」も含めて、OBS のプラグインを開発するのが理想的だが、普段 Android アプリ開発をしている私から見たら技術的に距離が遠くモチベーションが無い。
次善の策として Chrome 拡張として作るのが良いが、この機会を利用して Go 言語によるサーバサイドプログラミングを習得したい。2023年4月からサーバーサイドが Go 言語の会社で働いているが、モバイルのエンジニアもサーバサイドのプログラムを読めた方が何かと便利である。

# 課題解決のための要件

## 1ディレクトリに大量のリプレイバッファが保存され、どのファイルが前の試合のリプレイバッファか分からない問題

### 前提

[iKut 3　が搭載している画像分類モデルは試合の開始シーンを判別することができる](https://qiita.com/tfandkusu/items/b8b498d60ddff3db4d50#%E9%A0%AD%E5%87%BA%E3%81%97%E3%81%AE%E6%96%B9%E6%B3%95)

### iKut 3

- 試合が開始されたら、それを iKut Note に伝える
- リプレイバッファが保存されたら、そのパスを iKut Note に伝える

### iKut Note

- 試合の開始を受け取ったら、6桁連番のフォルダを作成する
- リプレイバッファ保存を受け取ったら、最新の6桁連番のフォルダに動画を移動する

## リプレイバッファを見るために適切な動画プレイヤーアプリが無い問題

- 保存したリプレイバッファを列挙できる
- ユーザが選択したリプレイバッファを再生できる
- ユーザは以下の操作ができる。これらは [iKut](https://ikut.app/) で実装済み
  - 再生開始
  - 一時停止
  - N秒進む
  - N秒戻る
  - スロー再生
  - Nをユーザが1〜10秒の範囲で調整できる

## リプレイバッファを見て気がついたことがあっても、書き留める場所が無い問題

- リプレイバッファからフレーム画像を取得
- フレーム画像に対して140次程度のメモを残せる
- フレーム画像の一覧を列挙
- フレーム画像を開いて、メモを確認して編集できる

ここら辺はミニマムで作成し、学習効果を見て検討する。
